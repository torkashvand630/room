"use strict";(function(n,t){typeof define=="function"&&define.amd?define(["./ResizeSensor.js"],t):typeof exports=="object"?module.exports=t(require("./ResizeSensor.js")):(n.ElementQueries=t(n.ResizeSensor),n.ElementQueries.listen())})(typeof window!="undefined"?window:this,function(n){var t=function(){function e(n){n||(n=document.documentElement);var t=window.getComputedStyle(n,null).fontSize;return parseFloat(t)||16}function c(n){if(!n.getBoundingClientRect)return{width:n.offsetWidth,height:n.offsetHeight};var t=n.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function l(n,t){var i=t.split(/\d/),r=i[i.length-1];t=parseFloat(t);switch(r){case"px":return t;case"em":return t*e(n);case"rem":return t*e();case"vw":return t*document.documentElement.clientWidth/100;case"vh":return t*document.documentElement.clientHeight/100;case"vmin":case"vmax":var u=document.documentElement.clientWidth/100,f=document.documentElement.clientHeight/100,o=Math[r==="vmin"?"min":"max"];return t*o(u,f);default:return t}}function a(n,i){this.element=n;var s,r,h,a,v,u,f,o,e=["min-width","min-height","max-width","max-height"];this.call=function(){h=c(this.element);u={};for(s in t[i])t[i].hasOwnProperty(s)&&(r=t[i][s],a=l(this.element,r.value),v=r.property==="width"?h.width:h.height,o=r.mode+"-"+r.property,f="",r.mode==="min"&&v>=a&&(f+=r.value),r.mode==="max"&&v<=a&&(f+=r.value),u[o]||(u[o]=""),f&&-1===(" "+u[o]+" ").indexOf(" "+f+" ")&&(u[o]+=" "+f));for(var n in e)e.hasOwnProperty(n)&&(u[e[n]]?this.element.setAttribute(e[n],u[e[n]].substr(1)):this.element.removeAttribute(e[n]))}}function o(t,i){t.elementQueriesSetupInformation||(t.elementQueriesSetupInformation=new a(t,i));t.elementQueriesSensor||(t.elementQueriesSensor=new n(t,function(){t.elementQueriesSetupInformation.call()}))}function v(n,u,f,e){if(typeof t[n]=="undefined"){t[n]=[];var o=r.length;i.innerHTML+="\n"+n+" {animation: 0.1s element-queries;}";i.innerHTML+="\n"+n+" > .resize-sensor {min-width: "+o+"px;}";r.push(n)}t[n].push({mode:u,property:f,value:e})}function s(n){var t;if(document.querySelectorAll&&(t=n?n.querySelectorAll.bind(n):document.querySelectorAll.bind(document)),t||"undefined"==typeof $$||(t=$$),t||"undefined"==typeof jQuery||(t=jQuery),!t)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return t}function y(n){var e=s(n),i,u,r,f;for(i in t)if(t.hasOwnProperty(i))for(u=e(i,n),r=0,f=u.length;r<f;r++)o(u[r],i)}function p(t){function a(){var n=!1,i,s;for(i in r)r.hasOwnProperty(i)&&e[i].minWidth&&t.offsetWidth>e[i].minWidth&&(n=i);n||(n=o);u!==n?h[n]?(r[u].style.display="none",r[n].style.display="block",u=n):(s=new Image,s.onload=function(){r[n].src=f[n];r[u].style.display="none";r[n].style.display="block";h[n]=!0;u=n},s.src=f[n]):r[n].src=f[n]}var r=[],e=[],f=[],o=0,u=-1,h=[],i,s,c,l;for(i in t.children)t.children.hasOwnProperty(i)&&t.children[i].tagName&&t.children[i].tagName.toLowerCase()==="img"&&(r.push(t.children[i]),s=t.children[i].getAttribute("min-width")||t.children[i].getAttribute("data-min-width"),c=t.children[i].getAttribute("data-src")||t.children[i].getAttribute("url"),f.push(c),l={minWidth:s},e.push(l),s?t.children[i].style.display="none":(o=r.length-1,t.children[i].style.display="block"));u=o;t.resizeSensorInstance=new n(t,a);a()}function w(){for(var i=s(),t=i("[data-responsive-image],[responsive-image]"),n=0,r=t.length;n<r;n++)p(t[n])}function u(n){var t,r,u,i;for(n=n.replace(/'/g,'"');null!==(t=b.exec(n));)for(r=t[1]+t[3],u=t[2];null!==(i=k.exec(u));)v(r,i[1],i[2],i[3])}function f(n){var i="",t,r;if(n)if("string"==typeof n)n=n.toLowerCase(),(-1!==n.indexOf("min-width")||-1!==n.indexOf("max-width"))&&u(n);else for(t=0,r=n.length;t<r;t++)1===n[t].type?(i=n[t].selectorText||n[t].cssText,-1!==i.indexOf("min-height")||-1!==i.indexOf("max-height")?u(i):(-1!==i.indexOf("min-width")||-1!==i.indexOf("max-width"))&&u(i)):4===n[t].type?f(n[t].cssRules||n[t].rules):3===n[t].type&&n[t].styleSheet.hasOwnProperty("cssRules")&&f(n[t].styleSheet.cssRules)}var i,t={},r=[],b=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/mgi,k=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/mgi,h=!1;this.init=function(){var u="animationstart",t,e;for(typeof document.documentElement.style.webkitAnimationName!="undefined"?u="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName!="undefined"?u="mozanimationstart":typeof document.documentElement.style.OAnimationName!="undefined"&&(u="oanimationstart"),document.body.addEventListener(u,function(t){var i=t.target,f=i&&window.getComputedStyle(i,null),e=f&&f.getPropertyValue("animation-name"),h=e&&-1!==e.indexOf("element-queries"),s,u;h&&(i.elementQueriesSensor=new n(i,function(){i.elementQueriesSetupInformation&&i.elementQueriesSetupInformation.call()}),s=window.getComputedStyle(i.resizeSensor,null),u=s.getPropertyValue("min-width"),u=parseInt(u.replace("px","")),o(t.target,r[u]))}),h||(i=document.createElement("style"),i.type="text/css",i.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",i.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(i),h=!0),t=0,e=document.styleSheets.length;t<e;t++)try{document.styleSheets[t].href&&0===document.styleSheets[t].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[t].href);f(document.styleSheets[t].cssRules||document.styleSheets[t].rules||document.styleSheets[t].cssText)}catch(s){}w()};this.findElementQueriesElements=function(n){y(n)};this.update=function(){this.init()}},i;return t.update=function(){t.instance.update()},t.detach=function(n){n.elementQueriesSetupInformation?(n.elementQueriesSensor.detach(),delete n.elementQueriesSetupInformation,delete n.elementQueriesSensor):n.resizeSensorInstance&&(n.resizeSensorInstance.detach(),delete n.resizeSensorInstance)},t.init=function(){t.instance||(t.instance=new t);t.instance.init()},i=function(n){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var t=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(n(),clearInterval(t))},10);else window.onload=n},t.findElementQueriesElements=function(n){t.instance.findElementQueriesElements(n)},t.listen=function(){i(t.init)},t});